<script>
// ====== Zmienne gry ======
let totalPoints = 0;
let clicks = 0;
let fastClicks = 0;
let rebirthCount = 0;
let currentNick = "";

// ====== Sprawdzenie przy starcie ======
window.onload = function() {
  const savedNick = localStorage.getItem('playerNick');
  if(savedNick) {
    currentNick = savedNick;
    document.getElementById('displayNick').innerText = currentNick;
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('gameScreen').style.display = 'block';
    // Przywróć punkty, rebirth i ranking
    totalPoints = parseInt(localStorage.getItem(currentNick + '_points')) || 0;
    rebirthCount = parseInt(localStorage.getItem(currentNick + '_rebirth')) || 0;
    clicks = parseInt(localStorage.getItem(currentNick + '_clicks')) || 0;
    fastClicks = parseInt(localStorage.getItem(currentNick + '_fastClicks')) || 0;
    document.getElementById('totalPoints').innerText = totalPoints;
    document.getElementById('rebirthCount').innerText = rebirthCount;
    document.getElementById('clicks').innerText = clicks;
    document.getElementById('fastClicks').innerText = fastClicks;
    updateRanking();
    losujZagadke();
  }
};

// ====== Logowanie ======
function startGame() {
  let nick = document.getElementById('playerNick').value.trim();
  if(nick === "") { alert("Podaj nick!"); return; }
  currentNick = nick;
  localStorage.setItem('playerNick', currentNick);
  document.getElementById('displayNick').innerText = currentNick;
  document.getElementById('loginScreen').style.display = 'none';
  document.getElementById('gameScreen').style.display = 'block';
  // Przywróć dane jeśli już były
  totalPoints = parseInt(localStorage.getItem(currentNick + '_points')) || 0;
  rebirthCount = parseInt(localStorage.getItem(currentNick + '_rebirth')) || 0;
  clicks = parseInt(localStorage.getItem(currentNick + '_clicks')) || 0;
  fastClicks = parseInt(localStorage.getItem(currentNick + '_fastClicks')) || 0;
  document.getElementById('totalPoints').innerText = totalPoints;
  document.getElementById('rebirthCount').innerText = rebirthCount;
  document.getElementById('clicks').innerText = clicks;
  document.getElementById('fastClicks').innerText = fastClicks;
  losujZagadke();
}

// ====== Funkcja dodawania punktów ======
function addPoints(p) {
  totalPoints += p;
  document.getElementById('totalPoints').innerText = totalPoints;
  // Zapis do localStorage
  localStorage.setItem(currentNick + '_points', totalPoints);
  updateRanking();
}

// ====== Funkcja Rebirth ======
function rebirth() {
  if(totalPoints >= 100000){
    totalPoints = 0;
    rebirthCount++;
    document.getElementById('rebirthCount').innerText = rebirthCount;
    localStorage.setItem(currentNick + '_rebirth', rebirthCount);
    localStorage.setItem(currentNick + '_points', totalPoints);
    alert(`Rebirth ×${rebirthCount}!`);
  } else {
    alert("Nie masz wystarczająco punktów (100 000)!");
  }
}

// ====== Ranking ======
let rankingData = [];
function updateRanking() {
  let exists = rankingData.findIndex(x => x.nick === currentNick);
  if(exists >= 0) { rankingData[exists].points = totalPoints; }
  else { rankingData.push({nick: currentNick, points: totalPoints}); }
  rankingData.sort((a,b)=>b.points-a.points);
  let top = rankingData.slice(0,100);
  let html = "";
  top.forEach(p => { html += `<li>${p.nick} - ${p.points} pkt</li>`; });
  document.getElementById('ranking').innerHTML = html;
}

// ====== Pozostałe gry i funkcje ======
// Tutaj wklej cały kod dla zagadek, klikacza, losowej liczby, szybkich kliknięć, karty itd.
// Pamiętaj, aby przy każdej zmianie punktów zapisywać w localStorage, np. klik(), losuj(), sprawdzZagadke()

</script>
