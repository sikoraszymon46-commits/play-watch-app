<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PlayWatch â€“ Gry i Ranking</title>
<style>
body { font-family: Arial; margin: 0; padding: 0; background:#f0f0f0;}
header, footer { background:#333; color:#fff; padding:10px; text-align:center;}
section { padding:10px; margin:10px; background:#fff; border-radius:5px;}
input, button { padding:5px; margin:5px;}
#gameScreen { display:none; }
</style>
</head>
<body>

<div id="loginScreen">
  <h1>ğŸ® Witaj!</h1>
  <p>Podaj nick:</p>
  <input type="text" id="playerNick" placeholder="TwÃ³j nick">
  <button onclick="startGame()">Zaczynam!</button>
</div>

<div id="gameScreen">
  <header>
    <h1>PlayWatch</h1>
    <p>Nick: <span id="displayNick"></span> | Punkty: <span id="totalPoints">0</span></p>
  </header>

  <section>
    <h2>ğŸ§© Zagadki</h2>
    <p id="riddleText">Kliknij "Nowa zagadka"</p>
    <input type="text" id="riddleAnswer" placeholder="OdpowiedÅº">
    <button onclick="checkRiddle()">SprawdÅº</button>
    <button onclick="newRiddle()">Nowa zagadka</button>
    <p id="riddleResult"></p>
  </section>

  <section>
    <h2>ğŸ† Ranking lokalny</h2>
    <ol id="ranking"></ol>
  </section>
</div>

<script>
let nick = '';
let points = 0;
let ranking = JSON.parse(localStorage.getItem('ranking')) || [];
const riddles = [
  {q:'Co zawsze roÅ›nie ale nigdy nie spada?', a:'wiek'},
  {q:'Co ma klucze ale nie moÅ¼e otworzyÄ‡ drzwi?', a:'fortepian'},
];
let currentRiddle = 0;

function startGame(){
  nick = document.getElementById('playerNick').value.trim();
  if(!nick){ alert('Podaj nick!'); return; }
  
  points = parseInt(localStorage.getItem(nick+'_points')) || 0;

  document.getElementById('displayNick').innerText = nick;
  document.getElementById('totalPoints').innerText = points;

  document.getElementById('loginScreen').style.display = 'none';
  document.getElementById('gameScreen').style.display = 'block';

  newRiddle();
  updateRanking();
}

function newRiddle(){
  currentRiddle = Math.floor(Math.random()*riddles.length);
  document.getElementById('riddleText').innerText = riddles[currentRiddle].q;
  document.getElementById('riddleAnswer').value = '';
  document.getElementById('riddleResult').innerText = '';
}

function checkRiddle(){
  const answer = document.getElementById('riddleAnswer').value.toLowerCase().trim();
  if(answer===riddles[currentRiddle].a){
    points += 10;
    alert('+10 pkt');
    document.getElementById('totalPoints').innerText = points;
    saveData();
    updateRanking();
  } else {
    alert('Å¹le!');
  }
}

function saveData(){
  localStorage.setItem(nick+'_points', points);
}

function updateRanking(){
  let exists = ranking.findIndex(x=>x.nick===nick);
  if(exists>=0) ranking[exists].points = points;
  else ranking.push({nick:nick, points:points});
  
  ranking.sort((a,b)=>b.points-a.points);
  if(ranking.length>100) ranking = ranking.slice(0,100);
  localStorage.setItem('ranking', JSON.stringify(ranking));

  const ol = document.getElementById('ranking');
  ol.innerHTML = '';
  ranking.forEach(r=>{ ol.innerHTML += `<li>${r.nick}: ${r.points} pkt</li>`; });
}
</script>

</body>
</html>
